<!DOCTYPE html>
<html lang="ja">
    <head><title>いわて大漁ナビ アニメーション</title></head>
    <body>
        <img src="" id="sd" alt="">
        <div id="sd_txt"></div>

        <form name="slide">
            <input type="button" value="開始" onclick="slidesw()">
            <div>
                アニメーション開始 <input id='length' type='text' value='8' />日前から
            </div>
            <div>
                切り替わり時間 <input id='ms' type='text' value='300' />ミリ秒
            </div>
        </form>
        <a href="http://www.suigi.pref.iwate.jp/satellite/">岩手県水産技術センター水産情報配信システム調べ</a>
        <script>
            var lengthDay = 8;
            var switchTime = 300;

            //画像を格納する配列の作成
            var image = new Array();
            var today = new Date();
            var startday = new Date();

            startday.setDate(today.getDate() - lengthDay);
            var year  = startday.getFullYear();
            var month = startday.getMonth()+1;
            var day   = startday.getDate();
            //配列の各要素を画像に特化して、そのパスを記入
            for(var i = 0; i < lengthDay; i++) {
                image[i]=new Image();
                image[i].src="http://www.suigi.pref.iwate.jp/satellite/display/image/Sc_"
                    + year + month + (day+i) + "0000.jpg";
                image[i].txt=year+"年"+month+"月"+(day+i)+"日";
            }

            if(document.getElementById) {
                document.getElementById("sd").src = image[lengthDay-1].src;
                document.getElementById("sd_txt").textContent = image[lengthDay-1].txt;
            }

            var cnt=0;

            function slidesw()
            {
                if(document.getElementById) {
                    //スライド中はボタンを押せなくする
                    document.slide.elements[0].disabled=true;

                    //id属性が「sd」の画像タグの画像パスを切り替える
                    document.getElementById("sd").src = image[cnt].src;
                    document.getElementById("sd_txt").textContent = image[cnt].txt;

                    lengthDay = document.getElementById('length').value;
                    switchTime = document.getElementById('ms').value;

                    //一つ画像を表示したらカウント用変数cntの値を＋１にする
                    cnt++;

                    //画像が最後まで表示されたか確認
                    if( cnt < lengthDay ) {
                        //setTimeout()で次の画像を表示する
                        var timer1=setTimeout("slidesw()",switchTime);
                    } else {
                        //ボタンを押せるようにして、タイマーを停止する
                        cnt=0;
                        document.slide.elements[0].disabled=false;
                        clearTimeout(timer1);
                    }
                }
            }
        </script>
    </body>
</html>
